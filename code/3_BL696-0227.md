---
scapolite:
    class: rule
    version: '0.51'
id: BL696-0227
id_namespace: com.siemens.seg.policy_framework.rule
title: Use NTFS File System
rule: <see below>
rationale: <see below>
description: <see below>
applicability:
  - system: com.siemens.cert.acp
    c: '123'
    i: '123'
    a: '123'
  - system: com.siemens.cert.scapolite.target_audience
    roles:
      - asset_manager
implementations:
  - relative_id: '01'
    description: <see below>
    automations:
      - system: org.scapolite.implementation.caveats
        caveat: automation_issue
        nature: no_automation
        description: |
            No automation of implementation possible
checks:
  - relative_id: '01'
    title: Checking the file system of all your volumes
    description: <see below>
    automations:
      - system: org.scapolite.automation.script
        automatibility: Full
        relative_id: '01'
        type: ps1
        caption: BL696-0227_C01_01
        identifier: BL696-0227_C01_01
        script: |
            Get-Volume | Select Size, FileSystemType | Where {$_.Size -gt 1GB}
        context: user
        expected:
            output_processor: Format-List
            each_item:
                key: FileSystemType
                equal_to: NTFS
            option: case_insensitive
crossrefs:
  - system: com.siemens.seg.policy_framework.rule
    idref: 12.1.1-05
    relation: based_on
history:
  - version: '2.5'
    date: '2020-01-16'
    action: modified
    description: Modified command to only return the file system type as return value.
        No other content changed; no need to set EVAL flag.
    internal_comment: ''
  - version: '2.4'
    date: '2019-07-05'
    action: revised
    description: Corrected a minor typo in the rule. No need to set an EVAL flag.
    internal_comment: ''
  - version: '1.11'
    date: '2017-08-01'
    action: revised
    hide: true
    description: Converted rule into Scapolite format.
    internal_comment: ''
  - version: '1.0'
    date: '2017-02-28'
    eval: true
    action: modified
    description: Measure published as v1.0.
    internal_comment: ''
  - version: '0.9'
    date: '2016-12-15'
    action: modified
    hide: true
    description: Version number increased to 0.9.
    internal_comment: ''
  - version: '0.4'
    action: modified
    hide: true
    description: Minor rewording to all sections; renamed title of the Measure.
    internal_comment: ''
  - version: '0.2'
    action: modified
    hide: true
    description: |
        Added the statement “Converting a FAT file system to NTFS is not
        permitted” to the *Measure* section as well as some small cosmetic
        changes.
    internal_comment: ''
  - version: '0.1'
    action: created
    hide: true
    description: |
        Measure created based on latest Windows 8.x measures and incorporating
        changes from Windows 7 release 2015-11-30.
    internal_comment: ''
---


## /rule

 a. Use the NTFS file system for all partitions (i.e., where the operating
   system resides, and any other partition used to store data).
 b. Do not convert an actual and running FAT disk or partition to NTFS. Format
    the disk or partition.

## /rationale

Although Microsoft offers a command-line tool to convert a FAT file system to
NTFS, not all security enhancements of NTFS are available after a conversion
and some software or applications might stop working.

## /description

Windows supports several file system types: FAT, FAT32, and NTFS. NTFS is the
preferred file system of Windows and offers improvements compared to FAT or
FAT32, in terms of performance, reliability, security ACLs, or auditing. File
security auditing and system access control on directory and file level can
only be enforced using NTFS.

## /implementations/0/description

When formatting a volume, select the NTFS type.

## /checks/0/description

Run the following PowerShell command to get the file system of all your
volumes:

::::: {.scapolite .AUTOGENERATED path='auto:01'}

~~~ {#listing_BL696-0227_C01_01.ps1 caption="Listing: BL696-0227_C01_01.ps1"}
(Get-Volume).FileSystem

~~~

:::::
